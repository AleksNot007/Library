{% extends "admin/change_list.html" %}
{% load i18n %}

{% block content_title %}
    <h1>Управление связями пользователей с книгами</h1>
{% endblock %}

{% block result_list %}
    <!-- Статистика по книгам -->
    <div class="module" style="margin-bottom: 20px;">
        <h2>Статистика по книгам</h2>
        
        <!-- Статистика по пользователям -->
        <div style="margin: 10px;">
            <h3>Книги по пользователям:</h3>
            <table style="width: 50%;">
                <tr>
                    <th>Пользователь</th>
                    <th>Всего книг</th>
                </tr>
                {% for stat in user_stats %}
                <tr>
                    <td>{{ stat.username }}</td>
                    <td>{{ stat.total_books }}</td>
                </tr>
                {% endfor %}
            </table>
        </div>

        <!-- Статистика по спискам -->
        <div style="margin: 10px;">
            <h3>Книги по спискам пользователей:</h3>
            <table style="width: 70%;">
                <tr>
                    <th>Пользователь</th>
                    <th>Тип списка</th>
                    <th>Количество книг</th>
                </tr>
                {% for stat in list_stats %}
                <tr>
                    <td>{{ stat.user__username }}</td>
                    <td>{{ stat.list_type }}</td>
                    <td>{{ stat.count }}</td>
                </tr>
                {% endfor %}
            </table>
        </div>
    </div>

    <!-- Стандартный список -->
    {{ block.super }}
{% endblock %} 